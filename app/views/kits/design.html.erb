
    <!-- The class below "expand-md" sets at what width the navbar will transform to a hamburger menu (If you change it to "lg" it will switch when the screen is wider)   -->
    <nav class="navbar navbar-expand-lg navbar-light navbarText">
        <a id="logoText" class="navbar-brand">
            <!-- <img id="kicklrLogo" src="pics/logo.png">  -->
            <img id="logo" src="pics/guitarLogo.png"> Caleb Elias G sounds
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
            aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item ">
                    <a id="latestReleasesLink" class="nav-link">Latest Releases</a>
                </li>

                <li class="nav-item ">
                    <a id="drumMachineLink" class="nav-link">Drum Machine</a>
                </li>


            </ul>
            <ul class="navbar-nav">
                <li class="nav-item ">
                    <a class="nav-link" target="_blank" href="https://soundcloud.com/calebeliasgmusic">SoundCloud</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" target="_blank" href="https://www.instagram.com/calebeliasgmusic/">Instagram</a>
                </li>
            </ul>

        </div>
    </nav>

    <!-- <div id="section1outerContainer"> -->
    <div id="section1">
        <div class="section1row"></div>
        <div class="section1row">
            <div id="section1BigTextOuterContainer">
                <div id="section1BigText">
                    <!-- Latest Releases -->
                </div>
            </div>
        </div>
        <div class="section1row">

        </div>
        <div class="section1row"></div>
        <!-- <div class="section1row"></div> -->
    </div>
    <div id="preSection2"></div>
    <div id="section2">
        <!-- <div id="absoluteSection2">
         
        </div> -->
        <div id="section2title">
            Latest Releases
        </div>

        <div id="mainContainer">
            <div id="chairsText"></div>
            <div id="cardsContainer">

                    <iframe class="soundclouds" id="sc-widget1" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/525402885&visual=true"></iframe>
    

                    <iframe class="soundclouds" id="sc-widget2" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/510851550&visual=true"></iframe>
                
                    <iframe class="soundclouds" id="sc-widget3" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/259976793&visual=true"></iframe>

                    <iframe class="soundclouds" id="sc-widget4" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/167569641&visual=true"></iframe>
                
                <div class="card" style="width: 18rem;">
                        <div id="playIconOuterContainer1" class="playIcon">
                                <i id="playAndPauseIcon1" class="fas fa-play fa-3x playAndPauseIcon"></i>
                        </div>
                    <h5 class="card-title">Beat Tape '18</h5>
                    <img class="card-img-top" src="pics/beatTape18Caleb.jpg" alt="Card image cap">
                    <div class="card-body">

                        <p class="card-text">
                            Released: 11/2/18

                        </p>

                    </div>

                </div>
                <!-- <div class="card" style="width: 18rem;">
                        <h5 class="card-title">Beat Tape '18</h5>
                        <img class="card-img-top" src="beatTape18Caleb.jpg" alt="Card image cap">
                        <div class="card-body">
    
                            <p class="card-text">
                                Released: 11/2/18
                               
                            </p>
    
                        </div>
    
                    </div> -->

                <div class="card" style="width: 18rem;">
                        <div id="playIconOuterContainer2" class="playIcon">
                                <i id="playAndPauseIcon2" class="fas fa-play fa-3x playAndPauseIcon"></i>
                        </div>
                    <!-- <div class="cdSide"></div> -->
                   
                    <h5 class="card-title">Tribute</h5>
                    <img class="card-img-top" src="pics/tributeCoverArtCalb.jpg" alt="Card image cap">
                    <div class="card-body">

                        <p class="card-text">
                            Released: 10/6/18

                        </p>

                    </div>

                </div>
            </div>
            <div id="cardsContainer">
                <div class="card" style="width: 18rem;">
                        <div class="playIcon">
                                <i id="playAndPauseIcon3" class="fas fa-play fa-3x playAndPauseIcon"></i>
                        </div>
                    <h5 class="card-title">C'est Yes EP</h5>
                    <img class="card-img-top" src="pics/c'estYesCoverArt.jpg" alt="Card image cap">
                    <div class="card-body">

                        <p class="card-text">xw Released: 4/20/16

                        </p>

                    </div>

                </div>

                <div class="card" style="width: 18rem;">
                        <div class="playIcon">
                                <i id="playAndPauseIcon4" class="fas fa-play fa-3x playAndPauseIcon"></i>
                        </div>
                    <h5 class="card-title">Kermit's Home</h5>
                    <img class="card-img-top" src="pics/kermitCoverArt.jpg" alt="Card image cap">
                    <div class="card-body">

                        <p class="card-text">
                            Released: 10/6/18

                        </p>

                    </div>

                </div>
            </div>
        </div>
        <!-- </div> -->






    </div>

    <div id="drumMachineSection">
        <div id="drumMachineSectionTitle">Drum Machine</div>

        <div id="drumMachineContainer">
            <div id="drumMachineTopContainer">
                <a id="drumMachineLogoText" class="navbar-brand">
                    <!-- <img id="kicklrLogo" src="pics/logo.png">  -->
                    <img id="drumMachineLogo" src="pics/guitarLogo.png"> Sounds from: "New Thang" - <span style="font-size: 13px">$3.99</span>
                </a>
                <div id="addToCartContainer">
                    <button type="button" class="btn btn-primary">
                        <i class="fas fa-shopping-cart"></i>
                        Add to cart

                    </button>
                </div>

            </div>

            <div id="drumMachineMainContainer">
                <div id="drumMachineLeftMain">
                    <div id="drumMachineLeftTop">
                        <div id="soundPackImageContainer">
                            <img id="soundPackImage" src="pics/beatTape18Caleb.jpg" alt="Smiley face">
                        </div>
                    </div>
                    <div id="drumMachineLeftBottom">

                        <div id="packsGallery">
                                <i id="prevBtn" class="fas fa-arrow-left fa-3x"></i>
                                <div class="galleryImageContainer">
                                        <img id="image1" src="pics/kermitCoverArt.jpg" class="galleryImage">
                                    </div>
                            <div class="galleryImageContainer" style="opacity: .8">
                                    <img id="image2" src="pics/beatTape18Caleb.jpg" class="galleryImage" >
                                </div>
                                <div class="galleryImageContainer">
                                        <img id="image3" src="pics/c'estYesCoverArt.jpg" class="galleryImage">
                                    </div>
                                    <div class="galleryImageContainer">
                                            <img id="image4" src="pics/tributeCoverArtCalb.jpg" class="galleryImage">
                                        </div>
                                        <div class="galleryImageContainer">
                                                <img id="image5" src="pics/kermitCoverArt.jpg" class="galleryImage">
                                            </div>
                                            <i id="nextBtn" class="fas fa-arrow-right fa-3x"></i>     
                        </div>

                        


                        <!-- <button type="button" class="btn btn-primary">Add to Cart</button> -->
                        <!-- <div id="shoppingCartOuterContainer"> -->
                        <!-- <div id="addToCartContainer">
                                    <button type="button" class="btn btn-primary">
                                            <i class="fas fa-shopping-cart"></i>
                                        Add to cart
                                      
                                    </button>
                                </div> -->
                        <!-- </div> -->
                    </div>
                </div>
                <div id="drumMachineRightMain">
                    <div class="padRow">
                        <div class="padContainer">
                            <div class="padText">
                                Guitar
                            </div>
                            <div class="pad">
                            </div>
                        </div>
                        <div class="padContainer">
                            <div class="padText">
                                Snare
                            </div>
                            <div class="pad"></div>
                        </div>
                        <div class="padContainer">
                            <div class="padText">
                                Piano
                            </div>
                            <div class="pad">

                            </div>
                        </div>
                        <div class="padContainer">
                            <div class="padText">
                                Bend1
                            </div>
                            <div class="pad"></div>
                        </div>
                    </div>
                    <div class="padRow">
                        <div class="padContainer">
                            <div class="padText">
                                Horn
                            </div>
                            <div class="pad"></div>
                        </div>
                        <div class="padContainer">
                            <div class="padText">
                                Kick
                            </div>
                            <div class="pad"></div>
                        </div>
                        <div class="padContainer">
                            <div class="padText">
                                808
                            </div>
                            <div class="pad"></div>
                        </div>
                        <div class="padContainer">
                            <div class="padText">
                                Clap
                            </div>
                            <div class="pad"></div>
                        </div>
                    </div>
                    <div class="padRow">
                        <div class="padContainer">
                            <div class="padText">
                                Guitar2
                            </div>
                            <div class="pad"></div>
                        </div>
                        <div class="padContainer">
                            <div class="padText">
                                Rhodes
                            </div>
                            <div class="pad"></div>
                        </div>
                        <div class="padContainer">
                            <div class="padText">
                                Tamborine
                            </div>
                            <div class="pad"></div>
                        </div>
                        <div class="padContainer">
                            <div class="padText"></div>
                            <div class="pad"></div>
                        </div>
                    </div>
                    <div class="padRow">
                        <div class="padContainer">
                            <div class="padText"></div>
                            <div class="pad"></div>
                        </div>
                        <div class="padContainer">
                            <div class="padText"></div>
                            <div class="pad"></div>
                        </div>
                        <div class="padContainer">
                            <div class="padText"></div>
                            <div class="pad"></div>

                        </div>
                        <div class="padContainer">
                            <div class="padText"></div>
                            <div class="pad"></div>

                        </div>
                    </div>
                </div>
            </div>
            <div id="drumMachineBottomContainer">
                <!-- <div id="shoppingCartOuterContainer">
                    <div id="addToCartContainer">
                        <button type="button" class="btn btn-primary">Add to Cart
                            <i class="fas fa-shopping-cart"></i>
                        </button>
                    </div>
                </div> -->
            </div>
        </div>
    </div>


  


    </div>
    </div>
    </div>

    <!-- <iframe id="soundcloud" width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/528224724&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe> -->

   




        <!-- <script data-dojo-config="async: 1"
            src="//ajax.googleapis.com/ajax/libs/dojo/1.10.4/dojo/dojo.js"></script> -->
            <!-- <script src="dojoTest.js"></script> -->
  
        


            <script src="https://w.soundcloud.com/player/api.js" type="text/javascript"></script>

<script>

let counterObj = {
};

let soundsObj = {}


document.addEventListener("DOMContentLoaded", function () {

console.log("WTF")

let pads = document.getElementsByClassName("pad")

let x = 1

<% @sounds.each do |sound| %>
    console.log("Heydrrff")
    soundsObj[`pad${x}`] = "<%=url_for(sound.soundfile)%>"
    x++


<%end %>



for (let i = 0; i < pads.length; i++) {
    counterObj[`newPadCounterpad${i + 1}`] = 0;
    pads[i].id = `pad${i + 1}`;





    
    pads[i].addEventListener('click', padDown)
    counterObj['newPadCounter' + (i + 1)] = 0;
}




function padDown() {
    console.log(this.id)

    playAndStop(this.id)

    let pad = this
    pad.classList.add("padDown")

    setTimeout(function () {
        pad.classList.remove("padDown")
    }, 80);

}



let firstPlayCounter;

var AudioContext = window.AudioContext || window.webkitAudioContext;

var context = new AudioContext();
console.log(context);


var gainNode = context.createGain();

function playSound(number) {

    window[`bufferNode${number}`]
    let bufferNodeName = window[`bufferNode${number}`]

    window[`bufferNode${number}`] = context.createBufferSource();

    var request = new XMLHttpRequest();
    request.open('GET', soundFile, true);
    request.responseType = 'arraybuffer';
    request.onload = function () {
        context.decodeAudioData(
            request.response,
            function (buffer) {
                window[`bufferNode${number}`].buffer = buffer;
                window[`bufferNode${number}`].connect(gainNode);
                gainNode.connect(context.destination);
                gainNode.gain.setValueAtTime(1, context.currentTime);
            },
            function (e) { console.log("Error with decoding audio data" + e.err); }
        );
    };
    request.send()
    window[`bufferNode${number}`].start()
};

function stopSound(number) {
    let bufferNodeName = window[`bufferNode${number}`]
    bufferNodeName.stop(context.currentTime);
};

function playAndStop(pad) {

    var numberPattern = /\d+/g;
    let number = pad.match(numberPattern).join([]);
    firstPlayCounter = counterObj[`newPadCounter${pad}`]
    counterObj[`newPadCounter${pad}`]++
    bufferNodeName = number

    soundFile = soundsObj[pad]


   

  soundFile = soundsObj[pad]

    if (firstPlayCounter === 0) {
        playSound(bufferNodeName, soundFile);
    }
    else {
        stopSound(bufferNodeName);
        playSound(bufferNodeName, soundFile);
    }

};

});


</script>

